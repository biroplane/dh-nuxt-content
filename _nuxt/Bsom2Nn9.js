const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./B55Ayr7o.js","./88kjj4NQ.js","./BPmUh52y.js"])))=>i.map(i=>d[i]);
import{at as D,B as P,_ as k}from"./88kjj4NQ.js";import{t as F}from"./BPmUh52y.js";const q=/\d/,H=["-","_","/","."];function M(e=""){if(!q.test(e))return e!==e.toLowerCase()}function U(e,s){const t=H,i=[];if(!e||typeof e!="string")return i;let r="",n,o;for(const c of e){const h=t.includes(c);if(h===!0){i.push(r),r="",n=void 0;continue}const p=M(c);if(o===!1){if(n===!1&&p===!0){i.push(r),r=c,n=p;continue}if(n===!0&&p===!1&&r.length>1){const a=r.at(-1);i.push(r.slice(0,Math.max(0,r.length-1))),r=a+c,n=p;continue}}r+=c,n=p,o=h}return i.push(r),i}function Q(e){return e?e[0].toUpperCase()+e.slice(1):""}function G(e,s){return e?(Array.isArray(e)?e:U(e)).map(t=>Q(s!=null&&s.normalize?t.toLowerCase():t)).join(""):""}function se(e,s){return e?(Array.isArray(e)?e:U(e)).map(t=>t.toLowerCase()).join("-"):""}function V(e){return{type:"root",children:e.value.map(x)}}function x(e){if(typeof e=="string")return{type:"text",value:e};const[s,t,...i]=e;return{type:"element",tag:s,props:t,children:i.map(x)}}const w=(e,s)=>{const t=e._conditions;return t.length>0?`(${t.join(` ${s} `)})`:""},C=e=>{const s=[],t={_conditions:s,where(i,r,n){let o;switch(r.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(n)){const c=n.map(h=>b(h)).join(", ");o=`"${String(i)}" ${r.toUpperCase()} (${c})`}else throw new TypeError(`Value for ${r} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(n)&&n.length===2)o=`"${String(i)}" ${r.toUpperCase()} ${b(n[0])} AND ${b(n[1])}`;else throw new Error(`Value for ${r} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":o=`"${String(i)}" ${r.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(i)}" ${r.toUpperCase()} ${b(n)}`;break;default:o=`"${String(i)}" ${r} ${b(typeof n=="boolean"?Number(n):n)}`}return s.push(`${o}`),t},andWhere(i){const r=i(C());return s.push(w(r,"AND")),t},orWhere(i){const r=i(C());return s.push(w(r,"OR")),t}};return t},K=(e,s)=>{const t={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},i={__params:t,andWhere(n){const o=n(C());return t.conditions.push(w(o,"AND")),i},orWhere(n){const o=n(C());return t.conditions.push(w(o,"OR")),i},path(n){return i.where("path","=",D(n))},skip(n){return t.offset=n,i},where(n,o,c){return i.andWhere(h=>h.where(String(n),o,c)),i},limit(n){return t.limit=n,i},select(...n){return n.length&&t.selectedFields.push(...n),i},order(n,o){return t.orderBy.push(`"${String(n)}" ${o}`),i},async all(){return s(e,r()).then(n=>n||[])},async first(){return s(e,r({limit:1})).then(n=>n[0]||null)},async count(n="*",o=!1){return s(e,r({count:{field:String(n),distinct:o}})).then(c=>c[0].count)}};function r(n={}){let o="SELECT ";if(n!=null&&n.count)o+=`COUNT(${n.count.distinct?"DISTINCT ":""}${n.count.field}) as count`;else{const h=Array.from(new Set(t.selectedFields));o+=h.length>0?h.map(p=>`"${String(p)}"`).join(", "):"*"}o+=` FROM ${F[String(e)]}`,t.conditions.length>0&&(o+=` WHERE ${t.conditions.join(" AND ")}`),t.orderBy.length>0?o+=` ORDER BY ${t.orderBy.join(", ")}`:o+=" ORDER BY stem ASC";const c=(n==null?void 0:n.limit)||t.limit;return c>0&&(t.offset>0?o+=` LIMIT ${c} OFFSET ${t.offset}`:o+=` LIMIT ${c}`),o}return i};function b(e){return`'${String(e).replace(/'/g,"''")}'`}async function Y(e,s=[]){var p;const t=e.__params;(p=t==null?void 0:t.orderBy)!=null&&p.length||(e=e.order("stem","ASC"));const i=await e.orWhere(a=>a.where("navigation","<>","false").where("navigation","IS NULL")).select("navigation","stem","path","title","meta",...s||[]).all(),{contents:r,configs:n}=i.reduce((a,u)=>{var d;if(String(u.stem).split("/").pop()===".navigation"){u.title=((d=u.title)==null?void 0:d.toLowerCase())==="navigation"?"":u.title;const m=u.path.split("/").slice(0,-1).join("/")||"/";a.configs[m]={...u,...u.body}}else a.contents.push(u);return a},{configs:{},contents:[]}),o=a=>({..._(["title",...s])(a),...a.meta,...j(a==null?void 0:a.navigation)?a.navigation:{}}),c=a=>({..._(["title",...s])(a),...j(a==null?void 0:a.navigation)?a.navigation:{}}),h=r.reduce((a,u)=>{var L;const d=u.path.substring(1).split("/"),m=u.stem.split("/"),f=!!((L=m[m.length-1])!=null&&L.match(/([1-9]\d*\.)?index/g)),$=l=>({title:l.title,path:l.path,stem:l.stem,children:[],...c(l)}),g=$(u);if(f){const l=n[g.path];if(typeof(l==null?void 0:l.navigation)<"u"&&(l==null?void 0:l.navigation)===!1)return a;if(u.path!=="/"){const y=$(u);g.children.push(y)}l&&Object.assign(g,o(l))}if(d.length===1){const l=a.find(y=>y.path===g.path&&y.page===!1);return f&&l?Object.assign(l,{page:void 0,children:[...g.children,...l.children]}):a.push(g),a}const I=d.slice(0,-1).reduce((l,y,O)=>{const E="/"+d.slice(0,O+1).join("/"),S=n[E];if(typeof(S==null?void 0:S.navigation)<"u"&&S.navigation===!1)return[];let v=l.find(N=>N.path===E);if(!v){const N=S?o(S):{};v={...N,title:N.title||z(y),path:E,stem:m.slice(0,O+1).join("/"),children:[],page:!1},l.push(v)}return v.children},a),T=I.find(l=>l.path===g.path&&l.page===!1);return T?Object.assign(T,{...g,page:void 0,children:[...g.children,...T.children]}):I.push(g),a},[]);return R(h)}function R(e){var t;const s=e;for(const i of s)(t=i.children)!=null&&t.length?R(i.children):delete i.children;return e}function _(e){return s=>(s=s||{},e&&e.length?e.filter(t=>typeof s[t]<"u").reduce((t,i)=>Object.assign(t,{[i]:s[i]}),{}):s)}function j(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}const z=e=>e.split(/[\s-]/g).map(G).join(" "),W=/^h([1-6])$/,J=e=>W.test(e);async function X(e,s){const{ignoredTags:t=[]}={};return(await e.where("extension","=","md").select("path","body","description","title").all()).flatMap(r=>Z(r,{ignoredTags:t}))}function Z(e,{ignoredTags:s}){var h,p,a,u;const t=!e.body||((h=e.body)==null?void 0:h.type)==="root"?e.body:V(e.body),i=e.path??"",r=[{id:i,title:e.title||"",titles:[],content:(e.description||"").trim(),level:1}];if(!(t!=null&&t.children))return r;let n=1,o=0;const c=[e.title??""];for(const d of t.children){const m=d.tag||"";if(J(m)){const f=Number(((p=m.match(W))==null?void 0:p[1])??0),$=A(d).trim();f===1?c.splice(0,c.length):f<o?c.splice(f-1,c.length-1):f===o&&c.pop(),r.push({id:`${i}#${(a=d.props)==null?void 0:a.id}`,title:$,titles:[...c],content:"",level:f}),c.push($),o=f,n+=1}else{const f=A(d,s).trim();if(n===1&&((u=r[n-1])==null?void 0:u.content)===f)continue;r[n-1].content=`${r[n-1].content} ${f}`.trim()}}return r}function A(e,s=[]){var i;let t="";return e.type==="text"&&(t+=e.value||""),s.includes(e.tag??"")?"":((i=e.children)!=null&&i.length&&(t+=e.children.map(r=>A(r,s)).filter(Boolean).join("")),t)}const ee=e=>{var t,i;const s=(i=(t=P())==null?void 0:t.ssrContext)==null?void 0:i.event;return K(e,(r,n)=>te(s,r,n))};function oe(e,s){return B(e,t=>Y(t,s))}function ae(e,s){return B(e,t=>X(t))}async function te(e,s,t){return ne(s,t)}async function ne(e,s){return await k(()=>import("./B55Ayr7o.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(i=>i.loadDatabaseAdapter(e)).then(i=>i.all(s))}function B(e,s){const t=ee(e),i={where(r,n,o){return t.where(String(r),n,o),i},andWhere(r){return t.andWhere(r),i},orWhere(r){return t.orWhere(r),i},order(r,n){return t.order(String(r),n),i},then(r,n){return s(t).then(r,n)},catch(r){return this.then(void 0,r)},finally(r){return this.then(void 0,void 0).finally(r)},get[Symbol.toStringTag](){return"Promise"}};return i}export{oe as a,ae as b,V as d,se as k,G as p,ee as q};
